<ion-view title="Notifications" ng-controller="NotificationsCtrl" class="view-bg">

	<ion-content>

		<ion-list>
		
			<ion-refresher
				pulling-text="Pull to refresh..."
				on-refresh="refresh()">
			</ion-refresher>

			<div class="notification-item list card item-text-wrap" ng-repeat="notification in notificationItems">
				<div class="item item-avatar item-text-wrap">
                   	<img ng-src="{{$root.node_url}}icon/{{notification.from_guid}}">

                    <div ng-switch="notification.notification_view">
                    	<!-- subscribed -->
                        <a href="#/tab/newsfeed/channel/{{notification.fromObj.guid}}" ng-switch-when="friends">
                    		<p>{{notification.fromObj.name}} subscribed to you</p>
                    	</a>
                    	<!-- group inivite -->
                        <div ng-switch-when="group_invite">
                        	<a>You've been invited to join {{notification.entityObj.name}}</a>
                        </div>
                        <!-- comment -->
                        <div ng-switch-when="comment">
                        	<!-- need to have multiple link options... some are objects, some are newsfeed -->
                        	
                        	<div ng-switch="notification.entityObj.type">
                        		<a ng-switch-when="object" href="#/tab/notifications/entity/{{notification.entityObj.guid}}">
                        			<p>{{notification.fromObj.name}} commented on {{notification.entityObj.title}}</p>
                        		</a>
                        		<a ng-switch-when="activity" href="#/tab/notifications/entity/{{notification.entityObj.guid}}">
                        			<p ng-if="notification.entityObj.owner_guid == $root.user_guid">
                        				{{notification.fromObj.name}} commented on your activity
                        			</p>
                        			<p ng-if="notification.entityObj.owner_guid != $root.user_guid">
                        			{{notification.fromObj.name}} commented on {{notification.entityObj.ownerObj.name}}'s activity
                        			</p>
                        		</a>
                        	</div>
                       	</div>
                       	<!-- up voted content -->
                        <div ng-switch-when="like">
							<a href="#/tab/notifications/entity/{{notification.entityObj.guid}}" ng-if="notification.entityObj.type == 'object'">
                        		<p>{{notification.fromObj.name}} voted up {{notification.entityObj.title}}</p>
                        	</a>
                        	<a href="#/tab/notifications/entity/{{notification.entityObj.guid}}" ng-if="notification.entityObj.type == 'activity'">
                        		<p>{{notification.fromObj.name}} voted up your activity</p>
                        	</a>
                        </div>
                        <!-- featured -->
                        <div ng-switch-when="feature">
                        	<a href="#/tab/notifications/entity/{{notification.entityObj.guid}}">
                        		<p>{{notification.entityObj.title}} was featured</p>
                        	</a>
                        </div>
                        <!-- mention -->
                        <div ng-switch-when="tag">
                        	<a href="#/tab/notifications/entity/{{notification.entityObj.guid}}">
                        		<p>{{notification.fromObj.name}} tagged you in a post</p>
                        	</a>
                        </div>
                    </div>
                    
                    <i class="icon ion-person-add notification-user-subscribe" 
						ng-if="notification.ownerObj.subscribed == false"
						ng-click="subscribe(notification)"> </i>
                   
                 </div>
			</div>

		</ion-list>
		
		<ion-infinite-scroll on-infinite="loadMore()" distance="1%" ng-if="hasMoreData"></ion-infinite-scroll>

	</ion-content>
</ion-view>