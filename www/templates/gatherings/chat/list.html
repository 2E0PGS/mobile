<ion-view title="Conversations" ng-controller="ChatCtrl" class="view-bg">

    <ion-content>

        <ion-list>
        
            <ion-refresher
                pulling-text="Pull to refresh..."
                on-refresh="refresh()">
            </ion-refresher>

            <ion-item ng-repeat="conversation in conversations" class="conversation" href="#/tab/gatherings/conversations/{{conversation.guid}}">
                <img image-cache ng-src="{{$root.node_url}}icon/{{conversation.guid}}/small" style="float:left;"/>
                <h2>{{conversation.name}}</h2>
                <p>{{conversation.last_msg * 1000 | date:'shortTime'}} - {{conversation.last_msg * 1000 | date:'longDate'}}</p>
                <span ng-show="conversation.unread == 1" style="position:absolute; top:20px; right:12px; border-radius:100%; display:block; background:green; width:12px; height:12px"></span>
            </ion-item>

        </ion-list>
        
        <ion-infinite-scroll 
            on-infinite="loadMore()" 
            distance="1%" 
            ng-if="hasMoreData">
        </ion-infinite-scroll>

    </ion-content>
</ion-view>